!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{SUx8:function(t,i,r){"use strict";r.r(i),r.d(i,"CustomersModule",(function(){return H}));var a,o=r("ofXK"),s=r("tyNb"),c=r("D/fu"),l=r("UgA8"),u=r("2Vo4"),d=r("fXoL"),m=r("aceb"),f=r("RS3s"),p=r("pLZG"),v=r("lJxs"),h=r("3Pt+"),b=((a=function(){function t(n,i,r,a,o,s){e(this,t),this.route=n,this.packageApi=i,this.auth=r,this.toast=a,this.nbMenuService=o,this.courierService=s,this.showDelivered=!1,this.settings={selectMode:"multi",add:{inputClass:"text-black",confirmCreate:!0,addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},edit:{confirmSave:!0,inputClass:"text-black",editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},actions:{add:!0,edit:!0,delete:!0,position:"right"},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0},columns:{id:{title:"Id",width:"0px",type:"number",filter:!1,editable:!1,addable:!1},trackingNo:{title:"Track No.",type:"string",filter:!1,valuePrepareFunction:function(e){return e.length>10?e.substr(0,10)+"...":e}},description:{title:"Desc.",type:"string",filter:!1},value:{title:"Value",type:"number",filter:!1},customsFee:{title:"Customs Fee",type:"number",filter:!1},weight:{title:"Weight",type:"number",filter:!1,width:"10px"},merchant:{title:"Merchant",type:"string",filter:!1},status:{title:"Status",type:"string",filter:!1,editor:{type:"list",config:{list:[{value:"Pre Alert",title:"Pre Alert"},{value:"At Warehouse",title:"At Warehouse"},{value:"In Transit",title:"In Transit"},{value:"Ready",title:"Ready"},{value:"Delivered",title:"Delivered"}]}}}}},this.packageDataSource=new f.b,this.packageUpdated=new d.EventEmitter,this.bulkActions=[{title:"Mark as Pre-Alert",data:"Pre Alert"},{title:"Mark as At Warehouse",data:"At Warehouse"},{title:"Mark as In Transit",data:"In Transit"},{title:"Mark as Ready",data:"Ready"},{title:"Mark as Delivered",data:"Delivered"}],this.selected=[],this.isAdmin=!1,this.isAdmin="administrator"===localStorage.getItem("role"),this.isAdmin||(this.settings.actions.delete=!1,this.settings.actions.add=!1,this.settings.actions.edit=!1)}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.selected=[],this.bulkButtonSub=this.nbMenuService.onItemClick().pipe(Object(p.a)((function(e){return"bulk-actions-menu"===e.tag})),Object(v.a)((function(e){return{title:e.item.title,data:e.item.data}}))).subscribe((function(t){return e.bulkAction(t)})),this.getPackages()}},{key:"ngOnDestroy",value:function(){this.bulkButtonSub.unsubscribe()}},{key:"getPackages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{neq:"Delivered"};this.packageApi.find({where:{ownerId:this.route.snapshot.params.id,status:t},order:"id DESC"}).subscribe((function(t){e.packageDataSource=new f.b(t)}))}},{key:"onPackageSearch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";""!==e&&this.packageDataSource.setFilter([{field:"trackingNo",search:e},{field:"id",search:e}],!1)}},{key:"viewPackage",value:function(e){}},{key:"onDeleteConfirm",value:function(e){var t=this;window.confirm("Are you sure you want to delete this package?")?this.packageApi.deleteById(e.data.id).subscribe((function(n){t.toast.success("Package successfully deleted","Success!"),e.confirm.resolve()}),(function(t){e.confirm.reject()})):e.confirm.reject()}},{key:"onCreateConfirm",value:function(e){var t,n,i,r=this;return e.newData.trackingNo?e.newData.description?e.newData.weight?e.newData.status?void this.packageApi.create({trackingNo:e.newData.trackingNo,description:e.newData.description,status:e.newData.status,value:null!==(t=e.newData.value)&&void 0!==t?t:1,customsFee:null!==(n=e.newData.customsFee)&&void 0!==n?n:0,weight:e.newData.weight,ownerId:this.route.snapshot.params.id,courierId:this.courierService.getId(),createdBy:null!==(i=this.auth.getCurrentUserId())&&void 0!==i?i:-1}).subscribe((function(t){r.toast.success("Package successfully created","Success!"),r.getPackages(),r.packageUpdated.emit(),e.confirm.resolve()}),(function(t){r.toast.danger("Failed to create package "+t.message,"Failed!"),e.confirm.reject()})):(this.toast.danger("Status is required","Add Package Failed"),void e.confirm.reject()):(this.toast.danger("Weight is required","Add Package Failed"),void e.confirm.reject()):(this.toast.danger("Description is required","Add Package Failed"),void e.confirm.reject()):(this.toast.danger("Tracking No is required","Add Package Failed"),void e.confirm.reject())}},{key:"onEditConfirm",value:function(e){var t=this;this.packageApi.patchAttributes(e.newData.id,{trackingNo:e.newData.trackingNo,description:e.newData.description,weight:e.newData.weight,status:e.newData.status,value:e.newData.value,customsFee:e.newData.customsFee,merchant:e.newData.merchant}).subscribe((function(n){t.toast.success("Package successfully updated","Success!"),e.confirm.resolve(),t.packageUpdated.emit()}),(function(n){t.toast.danger("Failed to update package","Failed!"),e.confirm.reject()}))}},{key:"toggleShowDelivered",value:function(e){var t={neq:"Delivered"};!0===e&&(t="Delivered"),this.getPackages(t)}},{key:"onUserRowSelect",value:function(e){this.selected=e.selected}},{key:"bulkAction",value:function(e){this.bulkUpdatePackageStatus(e.data)}},{key:"bulkUpdatePackageStatus",value:function(e){var t=this,n=this.selected.map((function(e){return e.id}));0!==n.length&&this.packageApi.updatePackageStatus(n,e).subscribe((function(e){t.toast.success("Packages updated successfully","Success!");var n={neq:"Delivered"};t.packageUpdated.emit(),t.showDelivered&&(n="Delivered"),t.getPackages(n),t.selected=[]}),(function(e){t.toast.danger(e.message,"Failed to update packages")}))}}]),t}()).\u0275fac=function(e){return new(e||a)(d["\u0275\u0275directiveInject"](s.a),d["\u0275\u0275directiveInject"](c.b),d["\u0275\u0275directiveInject"](c.i),d["\u0275\u0275directiveInject"](m.mb),d["\u0275\u0275directiveInject"](m.U),d["\u0275\u0275directiveInject"](l.a))},a.\u0275cmp=d["\u0275\u0275defineComponent"]({type:a,selectors:[["ngx-customer-package-table"]],outputs:{packageUpdated:"packageUpdated"},decls:12,vars:5,consts:[[1,"flex-between"],[1,"search"],["placeholder","Search... Enter 3 or more characters","type","text","nbInput","",3,"keydown.enter"],["search",""],["nbSuffix","","nbButton","","ghost","",3,"click"],["icon","search-outline","pack","eva"],[3,"ngModel","checkedChange","ngModelChange"],["nbButton","","status","success","nbContextMenuTag","bulk-actions-menu",3,"disabled","nbContextMenu"],[3,"settings","source","userRowSelect","deleteConfirm","createConfirm","editConfirm"]],template:function(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"div",0),d["\u0275\u0275elementStart"](1,"div"),d["\u0275\u0275elementStart"](2,"nb-form-field",1),d["\u0275\u0275elementStart"](3,"input",2,3),d["\u0275\u0275listener"]("keydown.enter",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275reference"](4);return t.onPackageSearch(e.value)})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](5,"button",4),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275reference"](4);return t.onPackageSearch(e.value)})),d["\u0275\u0275element"](6,"nb-icon",5),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](7,"nb-toggle",6),d["\u0275\u0275listener"]("checkedChange",(function(e){return t.toggleShowDelivered(e)}))("ngModelChange",(function(e){return t.showDelivered=e})),d["\u0275\u0275text"](8,"Show Delivered"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](9,"button",7),d["\u0275\u0275text"](10,"BULK ACTIONS"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](11,"ng2-smart-table",8),d["\u0275\u0275listener"]("userRowSelect",(function(e){return t.onUserRowSelect(e)}))("deleteConfirm",(function(e){return t.onDeleteConfirm(e)}))("createConfirm",(function(e){return t.onCreateConfirm(e)}))("editConfirm",(function(e){return t.onEditConfirm(e)})),d["\u0275\u0275elementEnd"]()}2&e&&(d["\u0275\u0275advance"](7),d["\u0275\u0275property"]("ngModel",t.showDelivered),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("disabled",0===t.selected.length)("nbContextMenu",t.bulkActions),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("settings",t.settings)("source",t.packageDataSource))},directives:[m.D,m.I,m.o,m.eb,m.F,m.nb,h.m,h.p,m.y,f.c],styles:[""]}),a),g=r("AytR");function k(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"ng2-smart-table",11),d["\u0275\u0275listener"]("userRowSelect",(function(e){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().onUserRowSelect(e)}))("deleteConfirm",(function(e){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().onDeleteConfirm(e)}))("custom",(function(e){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().onCustomAction(e)})),d["\u0275\u0275elementEnd"]()}if(2&e){var i=d["\u0275\u0275nextContext"]();d["\u0275\u0275property"]("settings",i.settings)("source",i.invoiceDataSource)}}function S(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",12),d["\u0275\u0275elementStart"](1,"h1"),d["\u0275\u0275text"](2,"Total"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](3,"p"),d["\u0275\u0275text"](4),d["\u0275\u0275pipe"](5,"currency"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate"](d["\u0275\u0275pipeBind1"](5,1,n.invoiceTotal))}}var w,y=((w=function(){function t(n,i,r,a,o,s,c){e(this,t),this.route=n,this.invoiceApi=i,this.packageApi=r,this.toast=a,this.mailbankApi=o,this.nbMenuService=s,this.courierService=c,this.bulkActions=[{title:"Mark as Paid",data:"Paid"},{title:"Mark as Unpaid",data:"Unpaid"},{title:"Send Via Email",data:"Send"}],this.settings={selectMode:"multi",actions:{add:!1,edit:!1,position:"right",custom:[{name:"view",title:'<i class="nb-maximize"></i>'}]},add:{inputClass:"text-black",confirmCreate:!0,addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0},columns:{id:{title:"Id",width:"0px",type:"number",filter:!1,editable:!1,addable:!1},courierPackageId:{title:"Package ID",type:"number",filter:!1,editor:{type:"list",config:{list:[]}}},sentInEmail:{title:"Sent via Email",type:"string",filter:!1,editable:!1,addable:!1},amount:{title:"Total",type:"number",filter:!1,editable:!1,addable:!1},status:{title:"Status",type:"string",filter:!1,editable:!1,addable:!1}}},this.showTable=!1,this.showPaid=!1,this.selected=[],this.invoiceDataSource=new f.b,this.refreshInvoice=new u.a(!1)}return n(t,[{key:"ngOnInit",value:function(){var e=this;this.bulkButtonSubscription=this.nbMenuService.onItemClick().pipe(Object(p.a)((function(e){return"bulk-actions-menu"===e.tag})),Object(v.a)((function(e){return{title:e.item.title,data:e.item.data}}))).subscribe((function(t){return e.bulkAction(t)})),this.refreshInvoice.subscribe((function(t){t&&(e.getInvoices(),e.refreshInvoice.next(!1))})),this.getInvoices(),this.getPackagesWihoutInvoice()}},{key:"ngOnDestroy",value:function(){this.bulkButtonSubscription.unsubscribe()}},{key:"getInvoices",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unpaid";this.invoiceApi.find({where:{customerId:this.route.snapshot.params.id,status:t},order:"id DESC",include:{relation:"courierPackage",fields:{id:!0,manifestNumber:!0}}}).pipe(Object(v.a)((function(e){return e.map((function(e){return{id:e.id,courierPackageId:e.courierPackage.manifestNumber?e.courierPackage.manifestNumber:e.courierPackageId,sentInEmail:e.sentInEmail?"YES":"NO",amount:e.amount.toFixed(2),status:e.status,manifestNumber:e.courierPackage.manifestNumber}}))}))).subscribe((function(t){e.invoiceDataSource=new f.b(t)}))}},{key:"onSearch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";""!==e&&this.invoiceDataSource.setFilter([{field:"courierPackageId",search:e},{field:"id",search:e},{field:"amount",search:e}],!1)}},{key:"viewInvoice",value:function(e){window.open("".concat(g.a.apiUrl,"/api/Invoices/preview?courierId=").concat(this.courierService.getId(),"&invoiceId=")+e.data.courierPackageId)}},{key:"onDeleteConfirm",value:function(e){var t=this;window.confirm("Are you sure you want to delete?")?this.invoiceApi.deleteById(e.data.id).subscribe((function(n){t.toast.success("Invoice successfully deleted","Success!"),e.confirm.resolve()}),(function(n){t.toast.danger("Failed to delete invoice","Failed!"),e.confirm.reject()})):e.confirm.reject()}},{key:"getPackagesWihoutInvoice",value:function(){var e=this;this.settings.columns.courierPackageId.editor.config.list=[],this.packageApi.find({where:{ownerId:this.route.snapshot.params.id}}).pipe(Object(v.a)((function(e){return e.map((function(e){return{title:"".concat(e.id," - ").concat(e.description),value:e.id}}))}))).subscribe((function(t){e.settings.columns.courierPackageId.editor.config.list=t,e.showTable=!0}))}},{key:"onUserRowSelect",value:function(e){this.selected=e.selected}},{key:"bulkAction",value:function(e){switch(e.data){case"Paid":case"Unpaid":this.bulkUpdateInvoiceStatus(e.data);break;case"Send":this.bulkSendInvoice();break;default:this.toast.default("Unrecognized action","Uhhhh!")}}},{key:"bulkUpdateInvoiceStatus",value:function(e){var t=this,n=this.selected.map((function(e){return e.id}));0!==n.length&&this.invoiceApi.bulkStatusChange(n,e).subscribe((function(e){t.toast.success("".concat(e.success," invoices deleted successfully out of ").concat(e.total),"Process Complete"),t.getInvoices(),t.selected=[]}),(function(e){return t.toast.danger("Failed to update invoices "+e.message,"Failed!")}))}},{key:"bulkSendInvoice",value:function(){var e=this,t=this.selected.map((function(e){return e.id}));t.length<=0||this.mailbankApi.bulkSendInvoices(t).subscribe((function(t){e.toast.success("Invoices queued up for sending.","Success!"),e.showPaid=!1,e.selected=[],e.getInvoices()}),(function(t){e.toast.danger(t.message,"Failed to Send Invoices")}))}},{key:"toggleShowPaid",value:function(e){!0===e?this.getInvoices("Paid"):this.getInvoices()}},{key:"onCustomAction",value:function(e){"view"===e.action&&this.viewInvoice(e)}},{key:"invoiceTotal",get:function(){return this.selected.reduce((function(e,t){return Number(e)+Number(t.amount)}),0)}}]),t}()).\u0275fac=function(e){return new(e||w)(d["\u0275\u0275directiveInject"](s.a),d["\u0275\u0275directiveInject"](c.g),d["\u0275\u0275directiveInject"](c.b),d["\u0275\u0275directiveInject"](m.mb),d["\u0275\u0275directiveInject"](c.k),d["\u0275\u0275directiveInject"](m.U),d["\u0275\u0275directiveInject"](l.a))},w.\u0275cmp=d["\u0275\u0275defineComponent"]({type:w,selectors:[["ngx-customer-invoice-table"]],inputs:{refreshInvoice:"refreshInvoice"},decls:14,vars:5,consts:[[1,"customer-invoice-table"],[1,"flex-between"],[1,"search"],["placeholder","Search... Enter 3 or more characters","type","text","nbInput","",3,"keydown.enter"],["search",""],["nbSuffix","","nbButton","","ghost","",3,"click"],["icon","search-outline","pack","eva"],[3,"ngModel","checkedChange","ngModelChange"],["nbButton","","status","success","nbContextMenuTag","bulk-actions-menu",3,"disabled","nbContextMenu"],[3,"settings","source","userRowSelect","deleteConfirm","custom",4,"ngIf"],["class","invoice-total",4,"ngIf"],[3,"settings","source","userRowSelect","deleteConfirm","custom"],[1,"invoice-total"]],template:function(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"section",0),d["\u0275\u0275elementStart"](1,"div",1),d["\u0275\u0275elementStart"](2,"div"),d["\u0275\u0275elementStart"](3,"nb-form-field",2),d["\u0275\u0275elementStart"](4,"input",3,4),d["\u0275\u0275listener"]("keydown.enter",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275reference"](5);return t.onSearch(e.value)})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](6,"button",5),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275reference"](5);return t.onSearch(e.value)})),d["\u0275\u0275element"](7,"nb-icon",6),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](8,"nb-toggle",7),d["\u0275\u0275listener"]("checkedChange",(function(e){return t.toggleShowPaid(e)}))("ngModelChange",(function(e){return t.showPaid=e})),d["\u0275\u0275text"](9,"Show Paid"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](10,"button",8),d["\u0275\u0275text"](11,"BULK ACTIONS"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275template"](12,k,1,2,"ng2-smart-table",9),d["\u0275\u0275elementEnd"](),d["\u0275\u0275template"](13,S,6,3,"div",10)}2&e&&(d["\u0275\u0275advance"](8),d["\u0275\u0275property"]("ngModel",t.showPaid),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("disabled",0===t.selected.length)("nbContextMenu",t.bulkActions),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",t.showTable),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngIf",t.selected.length>0))},directives:[m.D,m.I,m.o,m.eb,m.F,m.nb,h.m,h.p,m.y,o.n,f.c],pipes:[o.d],styles:[""]}),w);function I(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"form",1),d["\u0275\u0275elementStart"](1,"div",2),d["\u0275\u0275elementStart"](2,"div",3),d["\u0275\u0275elementStart"](3,"div",4),d["\u0275\u0275elementStart"](4,"label",5),d["\u0275\u0275text"](5,"First Name"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](6,"input",6),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](7,"div",3),d["\u0275\u0275elementStart"](8,"div",4),d["\u0275\u0275elementStart"](9,"label",5),d["\u0275\u0275text"](10,"Last Name"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](11,"input",7),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](12,"div",2),d["\u0275\u0275elementStart"](13,"div",3),d["\u0275\u0275elementStart"](14,"div",4),d["\u0275\u0275elementStart"](15,"label",5),d["\u0275\u0275text"](16,"Email"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](17,"input",8),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](18,"div",3),d["\u0275\u0275elementStart"](19,"div",4),d["\u0275\u0275elementStart"](20,"label",5),d["\u0275\u0275text"](21,"Phone Number"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](22,"input",9),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](23,"div",2),d["\u0275\u0275elementStart"](24,"div",3),d["\u0275\u0275elementStart"](25,"div",4),d["\u0275\u0275elementStart"](26,"label",5),d["\u0275\u0275text"](27,"Street 1"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](28,"input",10),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](29,"div",3),d["\u0275\u0275elementStart"](30,"div",4),d["\u0275\u0275elementStart"](31,"label",5),d["\u0275\u0275text"](32,"Street 2"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](33,"input",11),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](34,"div",2),d["\u0275\u0275elementStart"](35,"div",3),d["\u0275\u0275elementStart"](36,"div",4),d["\u0275\u0275elementStart"](37,"label",5),d["\u0275\u0275text"](38,"City"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](39,"input",12),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](40,"div",3),d["\u0275\u0275elementStart"](41,"div",4),d["\u0275\u0275elementStart"](42,"label",5),d["\u0275\u0275text"](43,"Parish"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](44,"input",13),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](45,"div",2),d["\u0275\u0275elementStart"](46,"div",3),d["\u0275\u0275elementStart"](47,"div",4),d["\u0275\u0275elementStart"](48,"nb-form-field"),d["\u0275\u0275elementStart"](49,"label",5),d["\u0275\u0275text"](50,"Tax Registration Number"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275element"](51,"input",14),d["\u0275\u0275elementStart"](52,"button",15),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().toggleShowPassword()})),d["\u0275\u0275element"](53,"nb-icon",16),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](54,"div",17),d["\u0275\u0275elementStart"](55,"button",18),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().updateProfile()})),d["\u0275\u0275text"](56,"UPDATE PROFILE"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](57,"button",19),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275nextContext"]();return e.sendPasswordResetEmail(e.userForm.controls.email.value)})),d["\u0275\u0275text"](58,"TRIGGER PASSWORD RESET"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()}if(2&e){var i=d["\u0275\u0275nextContext"]();d["\u0275\u0275property"]("formGroup",i.userForm),d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("formControl",i.userForm.controls.firstName),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("formControl",i.userForm.controls.lastName),d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("formControl",i.userForm.controls.email),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("formControl",i.userForm.controls.phoneNumber),d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("formControl",i.userForm.controls.street1),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("formControl",i.userForm.controls.street2),d["\u0275\u0275advance"](6),d["\u0275\u0275property"]("formControl",i.userForm.controls.city),d["\u0275\u0275advance"](5),d["\u0275\u0275property"]("formControl",i.userForm.controls.state),d["\u0275\u0275advance"](7),d["\u0275\u0275property"]("formControl",i.userForm.controls.trnNumber)("type",i.getInputType()),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("icon",i.showPassword?"eye-outline":"eye-off-2-outline"),d["\u0275\u0275attribute"]("aria-label",i.showPassword?"hide password":"show password"),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("disabled",i.userForm.invalid)}}var C,x,E=((x=function(){function t(n,i,r,a,o,s){e(this,t),this.fb=n,this.userApi=i,this.route=r,this.toast=a,this.mailbankApi=o,this.courierService=s,this.showPassword=!1}return n(t,[{key:"ngOnInit",value:function(){this.loadForm()}},{key:"loadForm",value:function(){var e=this;this.userApi.findById(this.route.snapshot.params.id).subscribe((function(t){e.userForm=e.fb.group({firstName:[t.firstName,[h.v.required]],lastName:[t.lastName,[h.v.required]],email:[{value:t.email,disabled:!1},[h.v.required,h.v.email]],phoneNumber:[t.contactInformation.mobilePhone,[h.v.required]],street1:[t.addresses[0].street1,[h.v.required]],street2:[t.addresses[0].street2,[h.v.required]],city:[t.addresses[0].city,[h.v.required]],state:[t.addresses[0].state,[h.v.required]],trnNumber:[t.trnNumber,[h.v.required]],userCreated:[t.createdOn,[]]})}))}},{key:"getInputType",value:function(){return this.showPassword?"text":"password"}},{key:"toggleShowPassword",value:function(){this.showPassword=!this.showPassword}},{key:"updateProfile",value:function(){var e=this,t=this.userForm.value;this.userApi.patchAttributes(this.route.snapshot.params.id,{firstName:t.firstName,lastName:t.lastName,contactInformation:{mobilePhone:t.phoneNumber},addresses:[{street1:t.street1,street2:t.street2,city:t.city,state:t.state}],trnNumber:t.trnNumber}).subscribe((function(t){e.toast.success("User profile updated successfully","Success!"),e.loadForm()}),(function(t){e.toast.danger("Failed to  updated user profile "+t.message,"Failed")}))}},{key:"sendPasswordResetEmail",value:function(e){var t=this;this.userApi.resetPassword({email:e,courierId:this.courierService.getId()}).subscribe((function(e){t.toast.success("Password reset email sent","Success")}),(function(e){t.toast.danger(e.message,"Failed")}))}}]),t}()).\u0275fac=function(e){return new(e||x)(d["\u0275\u0275directiveInject"](h.c),d["\u0275\u0275directiveInject"](c.e),d["\u0275\u0275directiveInject"](s.a),d["\u0275\u0275directiveInject"](m.mb),d["\u0275\u0275directiveInject"](c.k),d["\u0275\u0275directiveInject"](l.a))},x.\u0275cmp=d["\u0275\u0275defineComponent"]({type:x,selectors:[["ngx-customer-profile-form"]],decls:1,vars:1,consts:[[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"row"],[1,"col-sm-6"],[1,"form-group"],[1,"label"],["nbInput","","fullWidth","","placeholder","First Name",3,"formControl"],["nbInput","","fullWidth","","placeholder","Last Name",3,"formControl"],["nbInput","","fullWidth","","placeholder","Email",3,"formControl"],["nbInput","","fullWidth","","placeholder","Phone Number",3,"formControl"],["nbInput","","fullWidth","","placeholder","Street 1",3,"formControl"],["nbInput","","fullWidth","","placeholder","Street 2",3,"formControl"],["nbInput","","fullWidth","","placeholder","City",3,"formControl"],["nbInput","","fullWidth","","placeholder","Parish",3,"formControl"],["fullWidth","","nbInput","",3,"formControl","type"],["id","btn-suffix","nbSuffix","","nbButton","","ghost","",3,"click"],["pack","eva",3,"icon"],[1,"button-row"],["nbButton","","outline","","fullWidth","","status","success",3,"disabled","click"],["nbButton","","outline","","fullWidth","","status","warning",3,"click"]],template:function(e,t){1&e&&d["\u0275\u0275template"](0,I,59,14,"form",0),2&e&&d["\u0275\u0275property"]("ngIf",t.userForm)},directives:[o.n,h.x,h.n,h.f,m.I,h.b,h.m,h.e,m.D,m.o,m.eb,m.F],styles:["#btn-suffix[_ngcontent-%COMP%]{margin-top:25px}.button-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:1rem}"]}),x),P=((C=function(){function t(n){e(this,t),this.courierService=n}return n(t,[{key:"transform",value:function(e){return""+this.courierService.padMailboxNumber(e)}}]),t}()).\u0275fac=function(e){return new(e||C)(d["\u0275\u0275directiveInject"](l.a))},C.\u0275pipe=d["\u0275\u0275definePipe"]({name:"mailbox",type:C,pure:!0}),C);function F(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"p"),d["\u0275\u0275text"](1),d["\u0275\u0275pipe"](2,"currency"),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"](3);d["\u0275\u0275advance"](1),d["\u0275\u0275textInterpolate1"](" Amount Outstanding: ",d["\u0275\u0275pipeBind1"](2,1,n.balance.totalOutstanding)," ")}}function A(e,t){if(1&e&&(d["\u0275\u0275elementStart"](0,"div",1),d["\u0275\u0275elementStart"](1,"div",11),d["\u0275\u0275element"](2,"nb-icon",12),d["\u0275\u0275template"](3,F,3,3,"p",0),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](4,"div",11),d["\u0275\u0275element"](5,"nb-icon",13),d["\u0275\u0275elementStart"](6,"p"),d["\u0275\u0275text"](7),d["\u0275\u0275pipe"](8,"currency"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](9,"div",11),d["\u0275\u0275element"](10,"nb-icon",14),d["\u0275\u0275elementStart"](11,"p"),d["\u0275\u0275text"](12),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](13,"div",11),d["\u0275\u0275element"](14,"nb-icon",15),d["\u0275\u0275elementStart"](15,"p"),d["\u0275\u0275text"](16),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()),2&e){var n=d["\u0275\u0275nextContext"](2);d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngIf",n.balance),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate1"]("Amount Paid: ",d["\u0275\u0275pipeBind1"](8,4,n.balance.totalPaid),""),d["\u0275\u0275advance"](5),d["\u0275\u0275textInterpolate1"]("Undelivered Packages: ",n.packageCount.undeliveredPackages,""),d["\u0275\u0275advance"](4),d["\u0275\u0275textInterpolate1"]("Delivered of Packages: ",n.packageCount.deliveredPackages,"")}}function D(e,t){1&e&&(d["\u0275\u0275elementStart"](0,"nb-tab",16),d["\u0275\u0275element"](1,"ngx-customer-profile-form"),d["\u0275\u0275elementEnd"]())}function N(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"section"),d["\u0275\u0275elementStart"](1,"div",1),d["\u0275\u0275elementStart"](2,"div",2),d["\u0275\u0275elementStart"](3,"nb-card",3),d["\u0275\u0275elementStart"](4,"nb-card-header"),d["\u0275\u0275element"](5,"nb-user",4),d["\u0275\u0275pipe"](6,"mailbox"),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](7,"nb-card-body"),d["\u0275\u0275template"](8,A,17,6,"div",5),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](9,"div",1),d["\u0275\u0275elementStart"](10,"div",2),d["\u0275\u0275elementStart"](11,"nb-card",3),d["\u0275\u0275elementStart"](12,"nb-card-body"),d["\u0275\u0275elementStart"](13,"nb-tabset"),d["\u0275\u0275elementStart"](14,"nb-tab",6),d["\u0275\u0275elementStart"](15,"ngx-customer-package-table",7),d["\u0275\u0275listener"]("packageUpdated",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().onRefreshInvoices()})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](16,"nb-tab",8),d["\u0275\u0275element"](17,"ngx-customer-invoice-table",9),d["\u0275\u0275elementEnd"](),d["\u0275\u0275template"](18,D,2,0,"nb-tab",10),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()}if(2&e){var i=d["\u0275\u0275nextContext"]();d["\u0275\u0275advance"](5),d["\u0275\u0275propertyInterpolate2"]("name","",i.user.firstName," ",i.user.lastName,""),d["\u0275\u0275propertyInterpolate"]("title",d["\u0275\u0275pipeBind1"](6,6,i.user.mailboxes[0].mailboxNumber)),d["\u0275\u0275advance"](3),d["\u0275\u0275property"]("ngIf",i.balance&&i.packageCount),d["\u0275\u0275advance"](9),d["\u0275\u0275property"]("refreshInvoice",i.refreshInvoices),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngIf",i.isAdmin)}}var j,U=((j=function(){function t(n,i,r,a,o,s,c,l,d){e(this,t),this.activatedRoute=n,this.usersApi=i,this.invoiceApi=r,this.packageApi=a,this.iconsLibrary=o,this.toast=s,this.location=c,this.courierService=l,this.router=d,this.userPackages=[],this.userInvoices=[],this.refreshInvoices=new u.a(!1),this.isAdmin=!1,this.isAdmin="administrator"===localStorage.getItem("role"),o.registerFontPack("fa",{packClass:"fa",iconClassPrefix:"fa"})}return n(t,[{key:"ngOnInit",value:function(){var e=this.activatedRoute.snapshot.params.id;this.loadUser(e),this.loadCustomerBalances(e),this.loadCustomerPackageCount(e)}},{key:"loadUser",value:function(e){var t=this;this.usersApi.findById(e,{include:["mailboxes"]}).subscribe((function(e){t.user=e}),(function(e){t.toast.danger("An unexpected error occured, try again later.","An Error Occured"),t.router.navigate(["/pages/unknown"])}))}},{key:"loadCustomerBalances",value:function(e){var t=this;this.invoiceApi.getCustomerBalance(e).subscribe((function(e){t.balance=e}))}},{key:"loadCustomerPackageCount",value:function(e){var t=this;this.packageCount={deliveredPackages:0,undeliveredPackages:0},this.packageApi.count({status:"Delivered",ownerId:e}).subscribe((function(e){t.packageCount.deliveredPackages=e.count})),this.packageApi.count({status:{neq:"Delivered"},ownerId:e}).subscribe((function(e){t.packageCount.undeliveredPackages=e.count}))}},{key:"deleteUser",value:function(){var e=this;window.confirm("Are you sure you want to delete this user")&&this.usersApi.deleteById(this.activatedRoute.snapshot.params.id).subscribe((function(t){e.toast.success("User was successfully deleted","Success!"),e.location.back()}),(function(t){e.toast.danger("Failed to delete user","Failed!")}))}},{key:"sendPasswordResetEmail",value:function(){var e=this;this.usersApi.resetPassword({email:this.user.email,courierId:this.courierService.getId(),redirectUrl:"https://app.gemskycouriers.com"}).subscribe((function(t){e.toast.success("Password reset email was sent","Success!")}),(function(t){e.toast.danger(t.message,"Failed!")}))}},{key:"onRefreshInvoices",value:function(){this.loadCustomerBalances(this.activatedRoute.snapshot.params.id),this.refreshInvoices.next(!0)}}]),t}()).\u0275fac=function(e){return new(e||j)(d["\u0275\u0275directiveInject"](s.a),d["\u0275\u0275directiveInject"](c.e),d["\u0275\u0275directiveInject"](c.g),d["\u0275\u0275directiveInject"](c.b),d["\u0275\u0275directiveInject"](m.G),d["\u0275\u0275directiveInject"](m.mb),d["\u0275\u0275directiveInject"](o.j),d["\u0275\u0275directiveInject"](l.a),d["\u0275\u0275directiveInject"](s.c))},j.\u0275cmp=d["\u0275\u0275defineComponent"]({type:j,selectors:[["ngx-customer"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"row"],[1,"col-xxl-12"],["accent","info"],[3,"name","title"],["class","row",4,"ngIf"],["tabTitle","Packages"],[3,"packageUpdated"],["tabTitle","Invoices"],[3,"refreshInvoice"],["tabTitle","Profile",4,"ngIf"],[1,"col-sm-3"],["icon","file-invoice-dollar","pack","fa"],["icon","money-bill","pack","fa"],["icon","box","pack","fa"],["icon","box-open","pack","fa"],["tabTitle","Profile"]],template:function(e,t){1&e&&d["\u0275\u0275template"](0,N,19,8,"section",0),2&e&&d["\u0275\u0275property"]("ngIf",t.user)},directives:[o.n,m.r,m.t,m.qb,m.q,m.hb,m.gb,b,y,m.F,E],pipes:[P,o.d],styles:["nb-card-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:1rem}nb-card-body[_ngcontent-%COMP%]   .col-sm-3[_ngcontent-%COMP%]{text-align:center}nb-card-body[_ngcontent-%COMP%]   nb-icon[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:1rem}"]}),j),B=r("vkgz"),M=r("H/qo"),O=r("vxfF"),R=r("Bxrs"),T=r("kmnG"),V=r("7ZcW");function q(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"button",13),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"](),d["\u0275\u0275reference"](14).open()})),d["\u0275\u0275text"](1,"Import Customers"),d["\u0275\u0275elementEnd"]()}}function W(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"button",14),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().importCustomers()})),d["\u0275\u0275text"](1,"Upload File"),d["\u0275\u0275elementEnd"]()}if(2&e){var i=d["\u0275\u0275nextContext"]();d["\u0275\u0275property"]("disabled",i.fileUploadForm.invalid)("nbSpinner",i.processing)}}function _(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"nb-icon",15),d["\u0275\u0275listener"]("click",(function(){return d["\u0275\u0275restoreView"](n),d["\u0275\u0275nextContext"]().fileUploadForm.reset()})),d["\u0275\u0275elementEnd"]()}}var L,G,z,J=[{path:"",component:(L=function(){function t(n,i,r,a,o,s,c){e(this,t),this.usersApi=n,this.router=i,this.toast=r,this.dialogService=a,this.courierService=o,this.fb=s,this.uploadService=c,this.isAdmin=!1,this.processing=!1,this.settings={add:{inputClass:"text-black",confirmCreate:!0,addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},edit:{editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},actions:{add:!0,delete:!0,edit:!1,position:"right"},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0},columns:{id:{title:"Id",width:"0px",type:"number",filter:!1,editable:!1,addable:!1},mailboxNumber:{title:"Mailbox Number",type:"string",filter:!1,editable:!1,addable:!1},name:{title:"Name",type:"string",filter:!1},email:{title:"E-mail",type:"string",filter:!1},phoneNumber:{title:"Phone Number",type:"string",filter:!1}}},this.source=new f.b,this.customers=[],this.showAddForm=!1,this.acceptedFileTypes=[".csv"],this.isLoadingMore=!1,this.limit=9,this.offset=0,this.skip=0,this.isAdmin="administrator"===localStorage.getItem("role"),this.isAdmin||(this.settings.actions.delete=!1,this.settings.actions.add=!1,delete this.settings.columns.email)}return n(t,[{key:"ngOnInit",value:function(){this.getUsers(),this.fileUploadForm=this.fb.group({file:[null,[h.v.required]]})}},{key:"importCustomers",value:function(){var e=this;this.processing||(this.processing=!0,this.uploadService.uploadFile(this.fileUploadForm.value.file,"Uploads",this.courierService.getId().toString()).subscribe((function(t){e.usersApi.importFromCsv(e.courierService.getId(),t.name,!1).subscribe((function(t){e.processing=!1,e.toast.success("".concat(t.success," customers successfully imported out of ").concat(t.total),"File Import Result",{duration:1e4}),t.failed>0&&e.toast.danger(t.failed+" customers failed to be imported","File Import Failed",{duration:1e4}),t.exists>0&&e.toast.warning(t.exists+" customers were not imported because they already exist","File Import Duplicates",{duration:1e4}),e.fileUploadForm.reset(),e.getUsers()}),(function(t){e.toast.danger("Failed to import customers "+t.message,"Failed to import"),e.processing=!1}))}),(function(t){e.processing=!1,e.toast.danger("Failed to upload file "+t.message,"Failed",{duration:1e4})})))}},{key:"toggleAddForm",value:function(){this.showAddForm=!this.showAddForm}},{key:"resetSearch",value:function(e){(!e||e<=2)&&this.source.setFilter([])}},{key:"onSearch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e.length<2||this.source.setFilter([{field:"name",search:e},{field:"mailboxNumber",search:e},{field:"email",search:e},{field:"phoneNumber",search:e}],!1)}},{key:"getUsers",value:function(){var e=this;this.usersApi.find({where:{realm:this.courierService.getRealm()},include:["mailboxes"],order:"id DESC"}).pipe(Object(B.a)((function(t){e.customers=t})),Object(v.a)((function(t){return t.map((function(t){return{id:t.id,mailboxNumber:t.mailboxes.length>0?""+e.courierService.padMailboxNumber(t.mailboxes[0].mailboxNumber):"Unassigned",name:"".concat(t.firstName||"Profile"," ").concat(t.lastName||"Incomplete"),email:t.email,phoneNumber:t.contactInformation.mobilePhone}}))}))).subscribe((function(t){e.source=new f.b(t)}))}},{key:"viewCustomer",value:function(e){this.router.navigate(["/pages/customers",e.data.id])}},{key:"onDeleteConfirm",value:function(e){var t=this;window.confirm("Are you sure you want to delete?")?this.usersApi.deleteById(e.data.id).subscribe((function(n){t.toast.success("User successfully deleted","User Deleted"),e.confirm.resolve()}),(function(n){t.toast.danger("Failed to delete user"),e.confirm.reject()})):e.confirm.reject()}},{key:"onCreateConfirm",value:function(e){var t=this;return e.newData.name?e.newData.email?M.validate(e.newData.email)?e.newData.phoneNumber?void this.usersApi.create({email:e.newData.email,password:Math.random().toString(36).substr(2,11),realm:this.courierService.getRealm(),source:"Admin"}).subscribe((function(n){t.usersApi.patchAttributes(n.id,{firstName:e.newData.name.substr(0,e.newData.name.indexOf(" ")),lastName:e.newData.name.substr(e.newData.name.indexOf(" "),e.newData.name.length),contactInformation:{mobilePhone:e.newData.phoneNumber}}).subscribe((function(n){t.toast.success("User successfully created","Success!"),t.getUsers(),e.confirm.resolve()}),(function(n){t.toast.danger("Failed to update user profile "+n.mesage,"Failed"),e.confirm.reject()}))}),(function(n){t.toast.danger("Failed to create user "+n.message,"Failed!"),e.confirm.reject()})):(this.toast.danger("Phone number is invalid","Add Customer Failed"),void e.confirm.reject()):(this.toast.danger("Email name is invalid","Add Customer Failed"),void e.confirm.reject()):(this.toast.danger("Email name is required","Add Customer Failed"),void e.confirm.reject()):(this.toast.danger("Name is required","Add Customer Failed"),void e.confirm.reject())}}]),t}(),L.\u0275fac=function(e){return new(e||L)(d["\u0275\u0275directiveInject"](c.e),d["\u0275\u0275directiveInject"](s.c),d["\u0275\u0275directiveInject"](m.mb),d["\u0275\u0275directiveInject"](m.C),d["\u0275\u0275directiveInject"](l.a),d["\u0275\u0275directiveInject"](h.c),d["\u0275\u0275directiveInject"](R.a))},L.\u0275cmp=d["\u0275\u0275defineComponent"]({type:L,selectors:[["ngx-customers"]],viewQuery:function(e,t){var n;1&e&&d["\u0275\u0275viewQuery"](O.a,!0),2&e&&d["\u0275\u0275queryRefresh"](n=d["\u0275\u0275loadQuery"]())&&(t.viewport=n.first)},decls:19,vars:7,consts:[[1,"flex-between"],[1,"search"],["placeholder","Search... Enter 2 or more characters","type","text","nbInput","",3,"input","keydown"],["search",""],["nbSuffix","","nbButton","","ghost","",3,"click"],["icon","search-outline","pack","eva"],[1,"hidden"],["multiple","false",3,"accept","formControl"],["fileInput",""],["nbButton","","outline","","status","primary",3,"click",4,"ngIf"],["nbButton","","outline","","status","success",3,"disabled","nbSpinner","click",4,"ngIf"],["icon","close-outline","pack","eva",3,"click",4,"ngIf"],[3,"settings","source","userRowSelect","deleteConfirm","createConfirm"],["nbButton","","outline","","status","primary",3,"click"],["nbButton","","outline","","status","success",3,"disabled","nbSpinner","click"],["icon","close-outline","pack","eva",3,"click"]],template:function(e,t){if(1&e){var n=d["\u0275\u0275getCurrentView"]();d["\u0275\u0275elementStart"](0,"nb-card"),d["\u0275\u0275elementStart"](1,"nb-card-header"),d["\u0275\u0275text"](2," Customers "),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](3,"nb-card-body"),d["\u0275\u0275elementStart"](4,"div",0),d["\u0275\u0275elementStart"](5,"div"),d["\u0275\u0275elementStart"](6,"nb-form-field",1),d["\u0275\u0275elementStart"](7,"input",2,3),d["\u0275\u0275listener"]("input",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275reference"](8);return t.resetSearch(e.value.length)}))("keydown",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275reference"](8);return t.onSearch(e.value)})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](9,"button",4),d["\u0275\u0275listener"]("click",(function(){d["\u0275\u0275restoreView"](n);var e=d["\u0275\u0275reference"](8);return t.onSearch(e.value)})),d["\u0275\u0275element"](10,"nb-icon",5),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](11,"div"),d["\u0275\u0275elementStart"](12,"mat-form-field",6),d["\u0275\u0275element"](13,"ngx-mat-file-input",7,8),d["\u0275\u0275elementEnd"](),d["\u0275\u0275template"](15,q,2,0,"button",9),d["\u0275\u0275template"](16,W,2,2,"button",10),d["\u0275\u0275template"](17,_,1,0,"nb-icon",11),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementStart"](18,"ng2-smart-table",12),d["\u0275\u0275listener"]("userRowSelect",(function(e){return t.viewCustomer(e)}))("deleteConfirm",(function(e){return t.onDeleteConfirm(e)}))("createConfirm",(function(e){return t.onCreateConfirm(e)})),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"](),d["\u0275\u0275elementEnd"]()}2&e&&(d["\u0275\u0275advance"](13),d["\u0275\u0275property"]("accept",t.acceptedFileTypes)("formControl",t.fileUploadForm.controls.file),d["\u0275\u0275advance"](2),d["\u0275\u0275property"]("ngIf",!t.fileUploadForm.controls.file.value&&t.isAdmin),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngIf",t.fileUploadForm.controls.file.value),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("ngIf",t.fileUploadForm.controls.file.value),d["\u0275\u0275advance"](1),d["\u0275\u0275property"]("settings",t.settings)("source",t.source))},directives:[m.r,m.t,m.q,m.D,m.I,m.o,m.eb,m.F,T.a,V.a,h.m,h.e,o.n,f.c,m.cb],styles:[".hidden[_ngcontent-%COMP%]{display:none}"]}),L)},{path:":id",component:U}],K=((G=function t(){e(this,t)}).\u0275mod=d["\u0275\u0275defineNgModule"]({type:G}),G.\u0275inj=d["\u0275\u0275defineInjector"]({factory:function(e){return new(e||G)},imports:[[s.g.forChild(J)],s.g]}),G),Q=r("vTDv"),H=((z=function t(){e(this,t)}).\u0275mod=d["\u0275\u0275defineNgModule"]({type:z}),z.\u0275inj=d["\u0275\u0275defineInjector"]({factory:function(e){return new(e||z)},imports:[[o.c,K,o.c,h.g,m.p,m.z,m.u,m.pb,m.H,T.c,V.b,m.rb,m.R,m.J,m.ob,Q.a,m.db,m.E,m.ib,O.c,m.p,f.d,h.s]]}),z)}}])}();