(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{Yj9t:function(e,t,n){"use strict";n.r(t),n.d(t,"AuthModule",(function(){return A}));var a=n("ofXK"),s=n("tyNb"),r=n("McNs"),i=n("3Pt+"),o=n("UgA8"),l=n("AytR"),d=n("PqYM"),c=n("qXBG"),u=n("fXoL"),p=n("aceb");function m(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",11),u["\u0275\u0275element"](1,"img",12),u["\u0275\u0275elementEnd"]()),2&e){const e=t.ngIf;u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("src",e.imageUrl,u["\u0275\u0275sanitizeUrl"])}}function h(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1,"Login"),u["\u0275\u0275elementEnd"]())}function g(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1,"Forgot Password"),u["\u0275\u0275elementEnd"]())}function f(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1,"Change Password"),u["\u0275\u0275elementEnd"]())}function w(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1,"Login using your email address"),u["\u0275\u0275elementEnd"]())}function v(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1,"Enter your email address to reset your password"),u["\u0275\u0275elementEnd"]())}function y(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1,"Set your new password"),u["\u0275\u0275elementEnd"]())}function b(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",13),u["\u0275\u0275elementStart"](1,"label",14),u["\u0275\u0275text"](2,"Email address:"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275element"](3,"input",15),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](3),u["\u0275\u0275property"]("formControl",e.email)}}function S(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"div",13),u["\u0275\u0275elementStart"](1,"span",16),u["\u0275\u0275elementStart"](2,"label",17),u["\u0275\u0275text"](3,"Password:"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](4,"p",18),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().changeMode(1)})),u["\u0275\u0275text"](5," Forgot Password? "),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275element"](6,"input",19),u["\u0275\u0275elementEnd"]()}if(2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](6),u["\u0275\u0275property"]("formControl",e.password)}}function x(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"div",13),u["\u0275\u0275elementStart"](1,"span",16),u["\u0275\u0275elementStart"](2,"label",17),u["\u0275\u0275text"](3,"Confirm Password:"),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementEnd"](),u["\u0275\u0275element"](4,"input",19),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](4),u["\u0275\u0275property"]("formControl",e.confirmPassword)}}function V(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1,"Login"),u["\u0275\u0275elementEnd"]())}function C(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1,"Forgot Password"),u["\u0275\u0275elementEnd"]())}function M(e,t){1&e&&(u["\u0275\u0275elementStart"](0,"span"),u["\u0275\u0275text"](1,"Change Password"),u["\u0275\u0275elementEnd"]())}function P(e,t){if(1&e&&(u["\u0275\u0275elementStart"](0,"nb-alert",20),u["\u0275\u0275text"](1),u["\u0275\u0275elementEnd"]()),2&e){const e=u["\u0275\u0275nextContext"]();u["\u0275\u0275advance"](1),u["\u0275\u0275textInterpolate1"](" Please wait ",e.passwordResetTimer," seconds before resetting password again ")}}function E(e,t){if(1&e){const e=u["\u0275\u0275getCurrentView"]();u["\u0275\u0275elementStart"](0,"button",21),u["\u0275\u0275listener"]("click",(function(){return u["\u0275\u0275restoreView"](e),u["\u0275\u0275nextContext"]().changeMode(0)})),u["\u0275\u0275text"](1," Back to Login "),u["\u0275\u0275elementEnd"]()}}let I=(()=>{class e{constructor(e,t,n,a,s,r){this.fb=e,this.authService=t,this.toast=n,this.router=a,this.route=s,this.courierService=r,this.authMode=0,this.versionNumber=l.a.version,this.isLoading=!1,this.hasError=!1,this.passwordResetTimer=0,this.timeLeft=60,this.authService.isAuthenticated()&&this.router.navigate(["/main"])}ngOnInit(){this.authForm=this.fb.group({email:["",[i.v.required,i.v.email]],password:["",[i.v.required,i.v.minLength(8)]],confirmPassword:["",[]]}),this.route.params.subscribe(e=>{e.access_token?(this.accessToken=e.access_token,this.changeMode(2)):this.changeMode(0)})}get email(){return this.authForm.controls.email}get password(){return this.authForm.controls.password}get confirmPassword(){return this.authForm.controls.confirmPassword}submit(){this.isLoading=!0;const e=this.email.value,t=this.password.value,n=this.confirmPassword.value;0===this.authMode?this.authService.login(e,t).subscribe(e=>{this.isLoading=!1,this.authService.setCurrentUser(e),this.router.navigate(["/main"])},e=>{this.isLoading=!1,console.error(e),this.toast.danger("There was an error logging in, please try again later.","Failed",{duration:5e3})}):1===this.authMode?this.authService.resetPassword(e).subscribe(e=>{this.startTimer(),this.toast.success("A password reset link has been sent to your email. Please allow up to 5 minutes for the email to arrive.","Success",{duration:8e3}),this.isLoading=!1},e=>{this.isLoading=!1,this.toast.danger("There was an error in trying to reset your password","Failed")}):2===this.authMode&&this.authService.changePassword(t,n,this.accessToken).subscribe(e=>{this.isLoading=!1,this.toast.success("Password successfully changed, please login to continue","Success"),this.changeMode(0)},e=>{this.isLoading=!1,this.toast.danger("There was an error in trying to reset your password","Failed")})}matchValues(e){return t=>t.parent&&t.parent.value&&t.value===t.parent.controls[e].value?null:{isMatching:!1}}changeMode(e){switch(this.authMode=e,this.unsetAllValidators(),this.authMode){case 0:this.email.setValidators([i.v.required,i.v.email]),this.email.updateValueAndValidity(),this.password.setValidators([i.v.required,i.v.minLength(8)]),this.password.updateValueAndValidity();break;case 1:this.email.setValidators([i.v.required,i.v.email]),this.email.updateValueAndValidity();break;case 2:this.confirmPassword.setValidators([i.v.required,i.v.minLength(8),this.matchValues("password")]),this.confirmPassword.updateValueAndValidity(),this.password.setValidators([i.v.required,i.v.minLength(8)]),this.password.updateValueAndValidity();break;default:this.authMode=0,this.email.setValidators([i.v.required,i.v.email]),this.email.updateValueAndValidity(),this.password.setValidators([i.v.required,i.v.minLength(8)]),this.password.updateValueAndValidity()}}getError(e){const t=this.authForm.controls[e].errors;return t.required?"This field is required":t.email?"A valid email address is required":t.isMatching?"Please ensure both passwords match":t.minlength?"Passwords must have atleast 8 or more chacters":void 0}unsetAllValidators(){this.email.setValidators([]),this.password.setValidators([]),this.confirmPassword.setValidators([]),this.email.updateValueAndValidity(),this.password.updateValueAndValidity(),this.confirmPassword.updateValueAndValidity()}startTimer(){const e=Object(d.a)(1e3,2e3).subscribe(t=>{this.passwordResetTimer=this.timeLeft-t,this.passwordResetTimer<=0&&e.unsubscribe()})}}return e.\u0275fac=function(t){return new(t||e)(u["\u0275\u0275directiveInject"](i.c),u["\u0275\u0275directiveInject"](c.a),u["\u0275\u0275directiveInject"](p.mb),u["\u0275\u0275directiveInject"](s.c),u["\u0275\u0275directiveInject"](s.a),u["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=u["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-auth"]],decls:23,vars:23,consts:[["class","login-logo",4,"ngIf"],["id","title",1,"title",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"sub-title",3,"ngSwitch"],["aria-labelledby","title",3,"formGroup"],["form","ngForm"],["class","form-control-group",4,"ngIf"],["nbButton","","fullWidth","","status","primary","size","large",3,"disabled","ngSwitch","click"],["status","info",4,"ngIf"],["nbButton","","fullWidth","","size","large",3,"click",4,"ngIf"],[1,"version"],[1,"login-logo"],[3,"src"],[1,"form-control-group"],["for","input-email",1,"label"],["nbInput","","fullWidth","","type","email","name","email","id","input-email","pattern",".+@.+\\..+","placeholder","Email address","fieldSize","large","autofocus","",3,"formControl"],[1,"label-with-link"],["for","input-password",1,"label"],["href","",1,"forgot-password","caption-2",3,"click"],["nbInput","","fullWidth","","name","password","type","password","id","input-password","placeholder","Password","fieldSize","large",3,"formControl"],["status","info"],["nbButton","","fullWidth","","size","large",3,"click"]],template:function(e,t){1&e&&(u["\u0275\u0275template"](0,m,2,1,"div",0),u["\u0275\u0275pipe"](1,"async"),u["\u0275\u0275elementStart"](2,"h1",1),u["\u0275\u0275template"](3,h,2,0,"span",2),u["\u0275\u0275template"](4,g,2,0,"span",2),u["\u0275\u0275template"](5,f,2,0,"span",2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](6,"p",3),u["\u0275\u0275template"](7,w,2,0,"span",2),u["\u0275\u0275template"](8,v,2,0,"span",2),u["\u0275\u0275template"](9,y,2,0,"span",2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](10,"form",4,5),u["\u0275\u0275template"](12,b,4,1,"div",6),u["\u0275\u0275template"](13,S,7,1,"div",6),u["\u0275\u0275template"](14,x,5,1,"div",6),u["\u0275\u0275elementStart"](15,"button",7),u["\u0275\u0275listener"]("click",(function(){return t.submit()})),u["\u0275\u0275template"](16,V,2,0,"span",2),u["\u0275\u0275template"](17,C,2,0,"span",2),u["\u0275\u0275template"](18,M,2,0,"span",2),u["\u0275\u0275elementEnd"](),u["\u0275\u0275template"](19,P,2,1,"nb-alert",8),u["\u0275\u0275template"](20,E,2,0,"button",9),u["\u0275\u0275elementEnd"](),u["\u0275\u0275elementStart"](21,"p",10),u["\u0275\u0275text"](22),u["\u0275\u0275elementEnd"]()),2&e&&(u["\u0275\u0275property"]("ngIf",u["\u0275\u0275pipeBind1"](1,21,t.courierService.courierApplication)),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngSwitch",t.authMode),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngSwitchCase",0),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngSwitchCase",1),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngSwitchCase",2),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngSwitch",t.authMode),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngSwitchCase",0),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngSwitchCase",1),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngSwitchCase",2),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("formGroup",t.authForm),u["\u0275\u0275advance"](2),u["\u0275\u0275property"]("ngIf",2!=t.authMode),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",1!=t.authMode),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",2==t.authMode),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("disabled",t.authForm.invalid||t.passwordResetTimer)("ngSwitch",t.authMode),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngSwitchCase",0),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngSwitchCase",1),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngSwitchCase",2),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",t.passwordResetTimer),u["\u0275\u0275advance"](1),u["\u0275\u0275property"]("ngIf",0!=t.authMode),u["\u0275\u0275advance"](2),u["\u0275\u0275textInterpolate"](t.versionNumber))},directives:[a.n,a.p,a.q,i.x,i.n,i.f,p.o,p.I,i.b,i.r,i.m,i.e,p.j],pipes:[a.b],styles:[".forgot-password[_ngcontent-%COMP%]{cursor:pointer}button[_ngcontent-%COMP%]{margin-bottom:1rem}.login-logo[_ngcontent-%COMP%]{width:120px;height:120px;background-color:#fff;border-radius:120px;display:flex;align-items:center;justify-items:center;justify-content:center;margin:0 auto 2rem}.login-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px}.login-logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .version[_ngcontent-%COMP%]{text-align:center}"]}),e})();const k=[{path:"",component:r.a,children:[{path:"",redirectTo:"login"},{path:"login",component:I},{path:"reset-password/:access_token",component:I}]}];let L=(()=>{class e{}return e.\u0275mod=u["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[s.g.forChild(k)],s.g]}),e})(),A=(()=>{class e{}return e.\u0275mod=u["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=u["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.c,p.k,p.u,i.s,p.p,p.J,p.w,L,r.b]]}),e})()}}]);